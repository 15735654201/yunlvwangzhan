function evalCallFunction(fun,obj){    var funType = typeof(fun);    if(funType=="function"){        fun.call(obj);    }else if(funType=="string"){        eval(fun);    }}function isParaNull(obj){    var result = true;    var type = typeof(obj);    /*undefined or null return false*/    if(type == "undefined"        || obj == null){        result = true;    }    /*type is string */    else if (type == "string"){        obj = $.trim(obj);        if( obj==""            || obj == "undefined"){            result = true;        }else {            result = false;        }    }    /*other object */    else{        result = false;    }    return result;}/** * 初始化微信接口注入权限验证 * openid 关注用户的openid * notifyUrl 后台回调处理地址 * outTradeNo 订单号 * totalFee 订单金额（只能为整数） * okCall 支付成功时js回调 * failCall 支付失败时js回调 * **/function wxpay(options){  var ctx = options.ctx ? options.ctx : "";  var wx_appId = ''; //公众号  var wx_timeStamp = ''; //时间戳，自1970年以来的秒数  var wx_nonceStr = '';//随机串  var wx_prepay_id = '';//统一下单接口返回的prepay_id参数值  var wx_signType = '';//微信签名方式  var wx_paySign = '';//微信签名  $.ajax({         type: "POST",         url: ctx + "/sjfengWxPay/unifiedOrder",         data: {             openid: options.openid,             notifyUrl: options.notifyUrl,             outTradeNo: options.outTradeNo,             totalFee: options.totalFee,             body: options.goods_body,             appId: options.appId,             mchId: options.mchId,             key: options.key         },         dataType: "json",         async: false,         success:function(data) {                  if(data.state == 1) {                      wx_appId = data.cont.appId;                      wx_timeStamp = data.cont.timeStamp;                      wx_nonceStr = data.cont.nonceStr;                      wx_prepay_id = data.cont.package;                      wx_signType = data.cont.signType;                      wx_paySign = data.cont.paySign;                      onBridgeReady(options.okCall,options.failCall);                  }else if(data.state == 0){                      options.initFailCall(data.cont.msg+"::"+data.cont.msgCode);                  }          }        });    //H5页面支付    function onBridgeReady(okCall,failCall){        WeixinJSBridge.invoke(            'getBrandWCPayRequest', {                "appId" : wx_appId,                "timeStamp": wx_timeStamp,                "nonceStr" : wx_nonceStr,                "package" : wx_prepay_id,                "signType" : wx_signType,                "paySign" : wx_paySign            },            function(res){                if(res.err_msg == "get_brand_wcpay_request:ok" ) {                    if(!isParaNull(okCall)){                        evalCallFunction(okCall);                    }                }else{                    if(!isParaNull(failCall)){                        evalCallFunction(failCall);                    }                }            }        );    }}